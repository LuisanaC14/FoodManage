<div class="sidebar-wrapper" style="background: #111; border: 1px solid #333; padding: 25px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.5);">
    
    <div class="sidebar-widget mb-4">
        <div class="input-group">
            <input type="text" id="searchInput" class="form-control" placeholder="Buscar plato..." onkeyup="searchMenu()"
                   style="background: #000; border: 1px solid #444; color: #fff; border-radius: 8px 0 0 8px;">
            <button class="btn" type="button" onclick="searchMenu()" 
                    style="background: #ccff00; color: #000; font-weight: bold; border-radius: 0 8px 8px 0;">
                <i class="fas fa-search"></i>
            </button>
        </div>
    </div>

    <div class="sidebar-widget mb-4">
        <h5 class="widget-title" style="color: #fff; font-weight: 800; text-transform: uppercase; font-size: 1.1rem; border-left: 4px solid #ccff00; padding-left: 10px; margin-bottom: 20px;">
            Nuestro Menú
        </h5>
        <ul class="list-unstyled">
            <li class="mb-2">
                <a href="javascript:void(0)" onclick="filterMenu('todos', this)" class="cat-link active d-flex justify-content-between align-items-center text-decoration-none py-2" style="border-bottom: 1px solid #222; color: #aaa; transition: 0.3s;">
                    <span><i class="fas fa-utensils me-2"></i>Todo</span>
                    <span class="badge bg-dark text-white rounded-pill">{{ conteos.total }}</span>
                </a>
            </li>

            <li class="mb-2">
                <a href="javascript:void(0)" onclick="filterMenu('arroz', this)" class="cat-link d-flex justify-content-between align-items-center text-decoration-none py-2" style="border-bottom: 1px solid #222; color: #aaa; transition: 0.3s;">
                    <span><i class="fas fa-bowl-rice me-2"></i>Arroces</span>
                    <span class="badge bg-dark text-white rounded-pill">{{ conteos.arroz }}</span>
                </a>
            </li>

            <li class="mb-2">
                <a href="javascript:void(0)" onclick="filterMenu('sopa', this)" class="cat-link d-flex justify-content-between align-items-center text-decoration-none py-2" style="border-bottom: 1px solid #222; color: #aaa; transition: 0.3s;">
                    <span><i class="fas fa-bowl-food me-2"></i>Sopas</span>
                    <span class="badge bg-dark text-white rounded-pill">{{ conteos.sopa }}</span>
                </a>
            </li>

            <li class="mb-2">
                <a href="javascript:void(0)" onclick="filterMenu('porcion', this)" class="cat-link d-flex justify-content-between align-items-center text-decoration-none py-2" style="border-bottom: 1px solid #222; color: #aaa; transition: 0.3s;">
                    <span><i class="fas fa-drumstick-bite me-2"></i>Porciones</span>
                    <span class="badge bg-dark text-white rounded-pill">{{ conteos.porcion }}</span>
                </a>
            </li>

            <li class="mb-2">
                <a href="javascript:void(0)" onclick="filterMenu('bebida', this)" class="cat-link d-flex justify-content-between align-items-center text-decoration-none py-2" style="border-bottom: 1px solid #222; color: #aaa; transition: 0.3s;">
                    <span><i class="fas fa-cocktail me-2"></i>Bebidas</span>
                    <span class="badge bg-dark text-white rounded-pill">{{ conteos.bebida }}</span>
                </a>
            </li>

            <li class="mb-2">
                <a href="javascript:void(0)" onclick="filterMenu('extra', this)" class="cat-link d-flex justify-content-between align-items-center text-decoration-none py-2" style="border-bottom: 1px solid #222; color: #aaa; transition: 0.3s;">
                    <span><i class="fas fa-plus-circle me-2"></i>Extras</span>
                    <span class="badge bg-dark text-white rounded-pill">{{ conteos.extra }}</span>
                </a>
            </li>
        </ul>
    </div>

    <div class="sidebar-widget mb-4">
        <h5 class="widget-title" style="color: #fff; font-weight: 800; text-transform: uppercase; font-size: 1.1rem; border-left: 4px solid #ccff00; padding-left: 10px; margin-bottom: 20px;">
            Rango de Precio
        </h5>
        <div class="mt-3">
            <input type="range" class="form-range" min="1" max="50" step="1" id="priceRange" oninput="updatePriceLabel(this.value)" 
                   style="accent-color: #ccff00;">
            <div class="d-flex justify-content-between align-items-center mt-2">
                <span class="text-white small">Max: $<span id="priceValue" style="color: #ccff00; font-weight: bold;">25</span></span>
                <button class="btn btn-sm" onclick="filterByPrice()" style="border: 1px solid #ccff00; color: #ccff00; border-radius: 20px; font-size: 0.7rem;">FILTRAR</button>
            </div>
        </div>
    </div>
</div>

<style>
    .cat-link:hover, .cat-link.active { color: #ccff00 !important; padding-left: 10px; font-weight: bold; }
    .cat-link:hover .badge, .cat-link.active .badge { background: #ccff00 !important; color: #000 !important; }
    .menu-item { transition: all 0.3s ease; }
</style>

<script>
    // 1. FUNCIÓN DE FILTRADO (LA QUE FALTABA)
    function filterMenu(category, element) {
        // A. Resaltar el link activo
        document.querySelectorAll('.cat-link').forEach(link => link.classList.remove('active'));
        if(element) element.classList.add('active');

        // B. Mostrar/Ocultar platos
        let items = document.querySelectorAll('.menu-item');
        
        items.forEach(item => {
            // Buscamos la etiqueta "data-category" en cada plato
            let itemCategory = item.getAttribute('data-category'); 
            
            if (category === 'todos') {
                item.style.display = 'block'; // Mostrar todo
                item.classList.add('animate__fadeIn');
            } else {
                // Comparamos si la categoría del plato coincide con el botón
                if (itemCategory === category) {
                    item.style.display = 'block';
                    item.classList.add('animate__fadeIn');
                } else {
                    item.style.display = 'none';
                }
            }
        });
    }

    // 2. ACTUALIZAR ETIQUETA DE PRECIO
    function updatePriceLabel(val) {
        document.getElementById('priceValue').innerText = val;
    }
    
    // 3. FILTRAR POR PRECIO
    function filterByPrice() {
        let maxPrice = parseFloat(document.getElementById('priceRange').value);
        document.querySelectorAll('.menu-item').forEach(item => {
            let itemPrice = parseFloat(item.getAttribute('data-price') || 0);
            
            // Solo mostramos si el precio es menor al seleccionado Y si la categoría actual (si hubiera) coincide
            // Por simplicidad, aquí filtra sobre todo lo visible:
            if(itemPrice <= maxPrice && item.style.display !== 'none') {
                item.style.display = 'block';
            } else {
                item.style.display = 'none';
            }
        });
    }

    // 4. BUSCADOR EN TIEMPO REAL
    function searchMenu() {
        let text = document.getElementById('searchInput').value.toLowerCase();
        document.querySelectorAll('.menu-item').forEach(item => {
            let name = item.querySelector('h5') ? item.querySelector('h5').innerText.toLowerCase() : "";
            
            if(name.includes(text)) {
                item.style.display = 'block';
            } else {
                item.style.display = 'none';
            }
        });
    }
</script>